const input = `...........#..........#...........................#....................#......#........................................................#....
...#........................#..............................#...................................................................#............
......................................#...................................................................#...........#.....................
...............................................#...............#.......................#....................................................
..........................................#...........#.............................................#.......................................
..........#.................................................................#................................#..............................
................................#.................................................................................#......#..................
..................................................................#.........................................................................
............................................................#..................#.......................................................#....
................................................#............................................#...............................#..............
.....#..............#..............................................................#................................#.......................
.........................................#...............................................#.................................................#
..............................#................................#.......#....................................................................
........................................................................................................................#...................
...#......#.......#.................#...................#......................................#.......#.......#........................#...
...........................................#...............................#....................................................#...........
...................................................................................#........................................................
.............#............#........................................#.......................................#......#.........................
................................#............................#...............................#..............................................
........................................#.............#.........................#......#......................................#.............
........................................................................................................#.....#.............................
......#............#...............#..............#.........................................................................................
...........#..................#............#.....................#..................................................#.......................
.......................................................................#..................#................#.......................#........
..#...................................#.....................................#.....#..................#......................................
............................................................................................................................................
............................#........................#.........................................#............................................
.......#......................................................................................................................#.............
......................#.......................................................#.............................................................
.#...........................................................#.....#..................................................#.................#...
..................................#....................................................#....................................................
.................................................................................#..............................#...........................
........#.................................#..........#......................................#............#..................................
..................#........................................................#................................................................
.............................#................#......................#...............................#..........................#......#....
..............#......................#..................................................................................#...................
...............................................................................................................#............................
..#.....................#.......................................#...................................................#.......................
..................................#....................#..........................................#.........................................
....................#.....................#......#.........................................................................#.......#........
............................................................#..........#...................................................................#
....#........................#................................................#...........#...............#......#..........................
............................................................................................................................................
..........#............................#....................................................................................................
...............#...............................#......#.............................................#.................................#.....
......................#..........#.........................#.......#..................................................#.....................
...............................................................................................................#..................#........#
............................................................................................................................................
#..........................#...............................................#.......#......#.................................................
............................................................................................................................................
.......#......................................................#............................................................#........#.......
.............................................#.........#............................................#.....#.................................
...............................#.......#....................................................................................................
.................................................................#..........................#..................#............................
..............#.....#.........................................................#......#.....................................................#
.................................................#.......#.............#....................................................................
..............................................................#............................................#................................
.#.......................#...............#.................................#.........................................................#......
....................................#.....................................................#..............................#..................
.....#...........#..............................................................................#.....#.....................................
.................................................................#.................#........................................................
............................................................................................................................................
.................................................#........................................................#.................................
........#.........................................................................................#...........................#..........#..
...............#........#...........#.....#........................#..............................................#................#........
........................................................................................#...................................................
...................................................................................#.........................#..............................
...#..............#....................................................#............................#.......................................
..............................#............................#................................................................................
........................................#.............................................................................................#.....
..............................................#..................#.............#........................#.................#.................
...................................................#.............................................................#..........................
.........#..................................................................................................................................
.......................#.....................................#.......#.....#..............................................................#.
................................................................................................#.....................#.....................
....#...........................#......................#.............................#.......................................#..............
...........................................................................................................#................................
...........#.......#........#..............................#.....................................................#..........................
............................................#...............................................#...............................................
....................................................................#..............#..................#..............#...............#......
.....................................#........................#.............................................................................
...............................................#............................................................#.................#............#
............................................................................................................................................
....#.......#...........................................................................................................#.........#.........
...................................#................#...........#..............................#............................................
............................................................................................................................................
.......................................................................#...........#......#..........#.......#..............................
..............................................................................#......................................................#......
...........................#.....................#..................................................................#.......................
..#............#............................#................................................#..............................................
...........................................................................................................................................#
........................................#...............#............#..........#......................................#....................
............#................................................#..............................................................................
.......#............................#...............#....................................#............#..........................#..........
......................#....................................................#................................................................
...............................................................................................#.............#.....#........................
..................#....................................#.........#...............#..........................................................
.............#...............#................#........................................#.................................................#..
...................................#....................................................................#...................#...............
.........................................#..........#.................#.....................................................................
................#............................................................#..............................................................
..........#.....................#........................#.....................................................................#............
....#.................................#.............................................................................................#.......
......................#.....#.......................................................................................#.......................
..............................................#.........................................#...................................................
..........................................................................................................#.................................
...................................................................#.........................................................#..............
.........#....................#.........#.........#...........#....................................#......................................#.
............................................................................................................................................
..#........................................................................#...............#.............................#..................
..............#...........#..........................................................#..........................................#...........
...................#.................................#...............................................#......................................
...............................#......................................................................................................#.....
...........................................#.................#........#.......................#.............................................
.....................................#.....................................................................#......#.......#.................
................#...............................#................................#......#..........#......................................#.
........................#...................................................................................................................
..............................#................................................................................................#............
.........................................................#...................#..........................#...................................
....#.......................................................................................................................................
........................................................................#........................#......................#.............#.....
............#...............#.............#.........#............................#........#................#................................
.....................#...............#..............................................................................#.......................
..................................................................#......................................................................#..
............................................................................................................................................
..............#........................................#.....................#.......#......................................................
........................#..............................................#..............................................#........#............
........................................#........................................#..........................................................
.......#........................#...................#.........#..............................................#..............................
..#................#......................................................................#........................................#........
.................................................................................................#.......................#..................
..............................................#.............................................................................................
.....#........#...........................................................................................#.........#........#..............
.................................................................................#..........#..........................................#....
..........................#...................................#.........#..............#.........................................#..........
............................................................................................................................................
....................................................................#.......#...................#...........................................
......................#.............#.............#.....................................................#...................................
........................................................#........................................................#..........................
..#..........#..........................#....................................................................................#.......#......`

const exampleInput = `...#......
.......#..
#.........
..........
......#...
.#........
.........#
..........
.......#..
#...#.....`

function parseData(input: string): { x: number; y: number }[] {
  const inputPerLine = input.split('\n').map((line) => line.split(''))

  for (let lineIndex = 0; lineIndex < inputPerLine.length; lineIndex++) {
    const line = inputPerLine[lineIndex]
    const isEmptyLine = line.every((v) => v === '.')
    if (!isEmptyLine) continue

    const newEmptyLine = new Array(line.length).fill('.')
    inputPerLine.splice(lineIndex, 0, newEmptyLine)
    lineIndex++
  }

  for (let xIndex = 0; xIndex < inputPerLine[0].length; xIndex++) {
    const verticalLine: string[] = []
    for (const line of inputPerLine) {
      verticalLine.push(line[xIndex])
    }
    const isEmptyLine = verticalLine.every((value) => value === '.')
    if (!isEmptyLine) continue

    for (const line of inputPerLine) {
      line.splice(xIndex, 0, '.')
    }
    xIndex++
  }

  const galaxies: { x: number; y: number }[] = []

  for (let y = 0; y < inputPerLine.length; y++) {
    for (let x = 0; x < inputPerLine[y].length; x++) {
      const value = inputPerLine[y][x]
      if (value !== '#') continue
      galaxies.push({ y, x })
    }
  }

  return galaxies
}

function parseData2(input: string) {
  const inputPerLine = input.split('\n').map((line) => line.split(''))

  const emptyYLines = new Set<number>()
  const emptyXLines = new Set<number>()

  for (let lineIndex = 0; lineIndex < inputPerLine.length; lineIndex++) {
    const line = inputPerLine[lineIndex]
    const isEmptyLine = line.every((v) => v === '.')
    if (!isEmptyLine) continue

    emptyYLines.add(lineIndex)
  }

  for (let xIndex = 0; xIndex < inputPerLine[0].length; xIndex++) {
    const verticalLine: string[] = []
    for (const line of inputPerLine) {
      verticalLine.push(line[xIndex])
    }
    const isEmptyLine = verticalLine.every((value) => value === '.')
    if (!isEmptyLine) continue

    emptyXLines.add(xIndex)
  }

  const galaxies: { x: number; y: number }[] = []

  for (let y = 0; y < inputPerLine.length; y++) {
    for (let x = 0; x < inputPerLine[y].length; x++) {
      const value = inputPerLine[y][x]
      if (value !== '#') continue
      galaxies.push({ y, x })
    }
  }

  return {
    galaxies,
    emptyYLines,
    emptyXLines,
  }
}

export function solution1(input: string) {
  const parsedData = parseData(input)

  let total = 0

  for (let i = 0; i < parsedData.length - 1; i++) {
    const currentGalaxy = parsedData[i]
    const currentX = currentGalaxy.x
    const currentY = currentGalaxy.y

    for (let j = i + 1; j < parsedData.length; j++) {
      const aheadGalaxy = parsedData[j]
      const aheadGalaxyX = aheadGalaxy.x
      const aheadGalaxyY = aheadGalaxy.y

      const xDiff = Math.abs(currentX - aheadGalaxyX)
      const yDiff = Math.abs(currentY - aheadGalaxyY)

      total += xDiff + yDiff
    }
  }

  return total
}

export function solution1B(input: string) {
  const { galaxies, emptyXLines, emptyYLines } = parseData2(input)

  let total = 0

  for (let i = 0; i < galaxies.length - 1; i++) {
    const currentGalaxy = galaxies[i]
    const currentX = currentGalaxy.x
    const currentY = currentGalaxy.y

    for (let j = i + 1; j < galaxies.length; j++) {
      const aheadGalaxy = galaxies[j]
      const aheadGalaxyX = aheadGalaxy.x
      const aheadGalaxyY = aheadGalaxy.y

      let xDiff = aheadGalaxyX - currentX
      let yDiff = aheadGalaxyY - currentY

      if (aheadGalaxyY > currentY) {
        for (let yTravel = currentY; yTravel < aheadGalaxyY; yTravel++) {
          if (emptyYLines.has(yTravel)) {
            yDiff++
          }
        }
      }

      if (aheadGalaxyX > currentX) {
        for (let xTravel = currentX; xTravel < aheadGalaxyX; xTravel++) {
          if (emptyXLines.has(xTravel)) {
            xDiff++
          }
        }
      }

      if (currentY > aheadGalaxyY) {
        for (let yTravel = currentY; yTravel >= aheadGalaxyY; yTravel--) {
          if (emptyYLines.has(yTravel)) {
            yDiff--
          }
        }
      }

      if (currentX > aheadGalaxyX) {
        for (let xTravel = currentX; xTravel >= aheadGalaxyX; xTravel--) {
          if (emptyXLines.has(xTravel)) {
            xDiff--
          }
        }
      }

      total += Math.abs(xDiff) + Math.abs(yDiff)
    }
  }

  return total
}

export function solution2(input: string) {
  const { galaxies, emptyXLines, emptyYLines } = parseData2(input)

  let total = 0

  const ONE_MILLION = 1_000_000 - 1

  for (let i = 0; i < galaxies.length - 1; i++) {
    const currentGalaxy = galaxies[i]
    const currentX = currentGalaxy.x
    const currentY = currentGalaxy.y

    for (let j = i + 1; j < galaxies.length; j++) {
      const aheadGalaxy = galaxies[j]
      const aheadGalaxyX = aheadGalaxy.x
      const aheadGalaxyY = aheadGalaxy.y

      let xDiff = aheadGalaxyX - currentX
      let yDiff = aheadGalaxyY - currentY

      if (aheadGalaxyY > currentY) {
        for (let yTravel = currentY; yTravel < aheadGalaxyY; yTravel++) {
          if (emptyYLines.has(yTravel)) {
            yDiff += ONE_MILLION
          }
        }
      }

      if (aheadGalaxyX > currentX) {
        for (let xTravel = currentX; xTravel < aheadGalaxyX; xTravel++) {
          if (emptyXLines.has(xTravel)) {
            xDiff += ONE_MILLION
          }
        }
      }

      if (currentY > aheadGalaxyY) {
        for (let yTravel = currentY; yTravel >= aheadGalaxyY; yTravel--) {
          if (emptyYLines.has(yTravel)) {
            yDiff -= ONE_MILLION
          }
        }
      }

      if (currentX > aheadGalaxyX) {
        for (let xTravel = currentX; xTravel >= aheadGalaxyX; xTravel--) {
          if (emptyXLines.has(xTravel)) {
            xDiff -= ONE_MILLION
          }
        }
      }

      total += Math.abs(xDiff) + Math.abs(yDiff)
    }
  }

  return total
}

console.log('ðŸš€ ~ file: day11.ts:299 ~ solution1(exampleInput):', solution1(input))
console.log('ðŸš€ ~ file: day11.ts:300 ~ solution1(exampleInput):', solution1B(input))
console.log('ðŸš€ ~ file: day11.ts:300 ~ solution1(exampleInput):', solution2(input))
